## ï¼ï¼æœ€æ–°çš„ä»£ç å’Œæ–‡æ¡£è¯·å‰å¾€ [gitee æŸ¥çœ‹](https://gitee.com/MTrun/react-big-screen) ï¼ï¼

## ä¸€ã€é¡¹ç›®æè¿°

- [**Vue ç‰ˆæœ¬è¯·ç‚¹å‡»è¿™é‡ŒæŸ¥çœ‹ï¼Œä¹Ÿå¾ˆä¸é”™çš„(o ï¾Ÿ v ï¾Ÿ)ãƒï¼ï¼ï¼**](https://gitee.com/MTrun/big-screen-vue-datav)

- ä¸€ä¸ªåŸºäº Reactã€Dvaã€DataVã€ECharts æ¡†æ¶çš„ " **æ•°æ®å¤§å±é¡¹ç›®** "ã€‚æ”¯æŒæ•°æ®åŠ¨æ€åˆ·æ–°æ¸²æŸ“ã€å±å¹•é€‚é…ã€æ•°æ®è¯·æ±‚æ¨¡æ‹Ÿã€å±€éƒ¨æ ·å¼ã€å›¾è¡¨è‡ªç”±æ›¿æ¢/å¤ç”¨ç­‰åŠŸèƒ½ã€‚
- é¡¹ç›®éœ€è¦å…¨å±å±•ç¤ºï¼ˆæŒ‰ F11ï¼‰ã€‚
- é¡¹ç›®ç¯å¢ƒï¼šreact^16.2ã€webpack-4.0ã€npm-6.13ã€node-v12.16ã€‚
- è¯·æ‹‰å– master åˆ†æ”¯çš„ä»£ç ï¼Œå…¶ä½™æ˜¯å¼€å‘åˆ†æ”¯ã€‚

å‹æƒ…é“¾æ¥ï¼š

1.  [React å®˜æ–¹æ–‡æ¡£](https://react.docschina.org/docs/introducing-jsx.html)
2.  [Dva å®˜æ–¹æ–‡æ¡£](https://dvajs.com/guide/)
3.  [DataV å®˜æ–¹æ–‡æ¡£](http://datav-react.jiaminghi.com/guide/)
4.  [echarts å®ä¾‹](https://echarts.apache.org/examples/zh/index.html)ï¼Œ[echarts APIæ–‡æ¡£](https://echarts.apache.org/zh/api.html#echarts)
5.  [styled-components å®˜æ–¹æ–‡æ¡£](https://styled-components.com/)ï¼Œ[æ€å¦ç›¸å…³æ•™å­¦æ–‡ç« ](https://segmentfault.com/a/1190000014682665)
6.  [é¡¹ç›® gitee åœ°å€ï¼ˆå›½å†…é€Ÿåº¦å¿«ï¼‰](https://gitee.com/MTrun/react-big-screen)

é¡¹ç›®ç•Œé¢å›¾ï¼š
![ç•Œé¢å±•ç¤º](https://images.gitee.com/uploads/images/2020/0927/205317_db15e619_4964818.gif 'ç•Œé¢å±•ç¤º.gif')

## äºŒã€æ–‡ä»¶ç›®å½•ä»‹ç»

```shell
Project
â”œâ”€â”€ mock æ¨¡æ‹Ÿæ•°æ®
â”œâ”€â”€ src
â”‚  â”‚  â”œâ”€â”€ assets é™æ€èµ„æº
â”‚  â”‚  â”œâ”€â”€ components å„ä¸ªæ¨¡å—ç»„ä»¶
â”‚  â”‚  â”œâ”€â”€ models Dvaæ¨¡å‹ç®¡ç†
â”‚  â”‚  â”œâ”€â”€ routes è·¯ç”±ä¸»ç•Œé¢å®šä¹‰
â”‚  â”‚  â”œâ”€â”€ services å¼‚æ­¥è·å–å‡½æ•°
â”‚  â”‚  â”œâ”€â”€ style å…¨å±€æ ·å¼
â”‚  â”‚  â””â”€â”€ utils å·¥å…·å‡½æ•°
â”‚  â”‚
â”‚  â”œâ”€â”€ index.js ä¸»å‡½æ•°æ–‡ä»¶
â”‚  â””â”€â”€ router.jsx è·¯ç”±å®šä¹‰æ–‡ä»¶
â”‚
â””â”€â”€ .roadhogrc.mock.js å¯¼å‡ºæ¨¡æ‹Ÿæ•°æ®
```

## ä¸‰ã€è¯¦æƒ…ä»‹ç»

### å¯åŠ¨é¡¹ç›®

éœ€è¦æå‰å®‰è£…å¥½ `nodejs` ä¸ `npm`,ä¸‹è½½é¡¹ç›®ååœ¨é¡¹ç›®ä¸»ç›®å½•ä¸‹è¿è¡Œ `npm install` æ‹‰å–ä¾èµ–åŒ…ï¼Œä½¿ç”¨å‘½ä»¤ `npm run start` å¯åŠ¨é¡¹ç›®ï¼Œå¯åŠ¨é¡¹ç›®åéœ€è¦æ‰‹åŠ¨å…¨å±ï¼ˆæŒ‰ F11ï¼‰è¿›è¡ŒæŸ¥çœ‹ã€‚

### æ•°æ®è¯·æ±‚æ¨¡æ‹Ÿ

é¡¹ç›®é‡‡ç”¨ Dva è‡ªå¸¦æ¨¡æ‹Ÿæ•°æ®æ–¹å¼ï¼Œæ•°æ®æ”¾ç½®åœ¨ `mock` æ–‡ä»¶å¤¹ä¸­ï¼Œéœ€åœ¨ `.roadhogrc.mock.js` ä¸­è¿›è¡Œå¯¼å‡ºï¼Œç„¶ååœ¨ä¸»æ–‡ä»¶ `index.js` ä¸­è¿›è¡Œæ³¨å†Œã€‚

æ¥å£ Api è¯·æ±‚å‡½æ•°å†™åœ¨ `services/index.js` ä¸­ï¼Œå¹¶ç”± `models/*` æ–‡ä»¶é‡Œ `effects` å¯¹è±¡çš„å¼‚æ­¥å‡½æ•°å‘èµ·è¯·æ±‚ï¼Œç”±äºåœ¨ `subscriptions` é‡Œå¯¹è·¯ç”±è¿›è¡Œäº†ç›‘å¬è§¦å‘å¼‚æ­¥å‡½æ•°ï¼Œæ‰€ä»¥å½“æ‰“å¼€ç•Œé¢ä¼šè‡ªåŠ¨è§¦å‘å¯¹åº”å‡½æ•°ï¼Œå…·ä½“å†™æ³•è¯·å‚ç…§ Dva æ–‡æ¡£ã€‚

è¯·æ±‚å‡½æ•°ä½¿ç”¨ `Dva` è‡ªå¸¦çš„ `utils/request.js` ç»Ÿä¸€ä½¿ç”¨ Get è¯·æ±‚ï¼Œé»˜è®¤ä¸æ”¯æŒ POSTï¼Œéœ€è‡ªè¡Œä¿®æ”¹ã€‚

ç•Œé¢è·å– mock æ•°æ®ä¸ `react-redux` å†™æ³•ç±»ä¼¼ï¼Œåœ¨ `components/*` ä¸­ä½¿ç”¨ `connect` é«˜é˜¶å‡½æ•°è¿›è¡Œæ¥æ”¶å¹¶ä¼ å…¥å„ä¸ª `Chart` ç»„ä»¶å½“ä¸­ã€‚

### å›¾è¡¨ç»„ä»¶

å›¾è¡¨ç»„ä»¶ä¸»è¦ä½¿ç”¨äº† ECharts å’Œ DataV å¯è§†åŒ–æ¡†æ¶æ¥è¿›è¡Œå¼€å‘ã€‚å›¾è¡¨æ–‡ä»¶åœ¨ `components/*/charts` ä¸­ï¼Œé…ç½®æ–‡ä»¶åœ¨ `charts/options.js` é‡Œï¼ŒåŠ¨æ€æ•°æ®ç”±å„ä¸ª `page/index.js` è¿›è¡Œæ¥å—å’Œå¯¼å…¥ã€‚ECharts æ¸²æŸ“å‡½æ•°ç»Ÿä¸€å°è£…åœ¨äº† `utils/chart.js` ä¸­ã€‚

### æ ·å¼ç¼–å†™

æ ·å¼ç¼–å†™ä½¿ç”¨äº† `styled-components` æ’ä»¶ï¼Œé€šè¿‡æ ·å¼ç»„ä»¶åŒ–å®ç°ç±»ä¼¼ Vue ä¸­çš„ scoped åŠŸèƒ½ï¼Œç•Œé¢ä¸­çš„æ ·å¼ä¸ä¼šäº’ç›¸å½±å“ï¼Œæœ€ç®€å•çš„ä¾‹å­å¦‚ä¸‹ï¼š

æ ·å¼æ–‡ä»¶ styleï¼š

```js
import styled from 'styled-components';

// ç”Ÿæˆ div æ ‡ç­¾
export const Index = styled.div`
  display: flex;
  flex-direction: column;
  align-items: center;
`;
```

ä½¿ç”¨æ–¹å¼ï¼š

```js
import { Index } from './style';

//......

 render() {
   return (
    //  ç¼–è¯‘ä¹‹åå†…å®¹è¢« div æ ‡ç­¾åŒ…è£¹
     <Index> å†…å®¹ </Index>
   )
 }
```
`styled-components` è¿˜æ‹¥æœ‰ä¼ å‚ã€ç»§æ‰¿ã€å®šä¹‰å±æ€§ç­‰åŠŸèƒ½ï¼Œå¦‚æœ‰éœ€è¦è¯·å‰å¾€å®˜ç½‘æ·±åº¦å­¦ä¹ ã€‚

å…¨å±€æ ·å¼é€šè¿‡ `styled-components â€”> createGlobalStyle` å¼•å…¥åˆ°äº† router.jsx ä¸­å¹¶æ³¨å†Œåˆ°å…¨å±€ï¼Œå…·ä½“å‚è€ƒä¸‹æ–¹ `icon` å¼•å…¥æ–¹å¼ã€‚

### icon æ–‡ä»¶

icon æ–‡ä»¶ä½¿ç”¨ `iconfont` å›¾æ ‡ï¼ŒåŒæ ·ä½¿ç”¨ `styled-components` è¿›è¡Œæ³¨å†Œï¼Œéœ€è¦å¤šä¸€ä¸ªå¤„ç†æ­¥éª¤ã€‚

- ä¸‹è½½ `unicode` æ–‡ä»¶åˆ°é¡¹ç›®ä¸­å¦‚ `assets/icon`ï¼Œåˆ é™¤å¤šä½™ `demo*` å’Œ `iconfont.js`ã€‚
- å°† `iconfont.css` æ–‡ä»¶ä¿®æ”¹åç¼€ä¸º `iconfont.js`ã€‚
- æ‰“å¼€ `iconfont.css` æ–‡ä»¶ä¿®æ”¹ä¸ºä»¥ä¸‹æ ¼å¼ï¼š

```js
import { createGlobalStyle } from 'styled-components';

// ä½¿ç”¨ styled-components å…¨å±€æ³¨å†Œå‡½æ•°åŒ…è£¹å†…å®¹å¹¶å¯¼å‡º
export const Iconstyle = createGlobalStyle`
  @font-face {font-family: "iconfont";
  ......
`
- ä¸å…¨å±€æ ·å¼ä¸€æ ·åœ¨ `router.jsx` ä¸­è¿›è¡Œæ³¨å†Œã€‚
```

### å±å¹•é€‚é…

æœ¬é¡¹ç›®å€ŸåŠ©äº† `utils/flexible.js` æ’ä»¶ï¼Œé€šè¿‡æ”¹å˜ rem çš„å€¼æ¥è¿›è¡Œé€‚é…ï¼ŒåŸè®¾è®¡ä¸º 1920pxã€‚ ï¼Œé€‚é…åŒºé—´ä¸ºï¼š1366px ~ 2560pxï¼Œæœ¬é¡¹ç›®æœ‰æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œæºæ–‡ä»¶çš„æ›´æ”¹ï¼Œå°å±å¹•ï¼ˆå¦‚:å®½ä¸º 1366pxï¼‰éœ€è¦è‡ªå·±èˆå¼ƒéƒ¨åˆ†åŠ¨æ€ç»„ä»¶è¿›è¡Œé€‚é…ï¼Œå¦‚'åŠ¨æ€æ–‡å­—å˜æ¢ç»„ä»¶'ä¼šå½±å“å¸ƒå±€ï¼Œéœ€è¦æ‰‹åŠ¨æ¢æˆä¸€èˆ¬èŠ‚ç‚¹ï¼Œ

```js
// flexibleæ–‡ä»¶ä½ç½®: `common/flexible.js`,ä¿®æ”¹éƒ¨åˆ†å¦‚ä¸‹
function refreshRem() {
  var width = docEl.getBoundingClientRect().width;
  // æœ€å°1366pxï¼Œæœ€å¤§é€‚é…2560px
  if (width / dpr < 1366) {
    width = 1366 * dpr;
  } else if (width / dpr > 2560) {
    width = 2560 * dpr;
  }
  // åŸé¡¹ç›®æ˜¯1920pxæˆ‘è®¾ç½®æˆ24ç­‰ä»½ï¼Œè¿™æ ·1remå°±æ˜¯80px
  var rem = width / 24;
  docEl.style.fontSize = rem + 'px';
  flexible.rem = win.rem = rem;
}
```

### è§£å†³ Dva ç‰ˆæœ¬ history æŠ¥é”™çš„é—®é¢˜

æ‰¾åˆ° node_modules ä¸­çš„ dva åŒ…ï¼Œä¿®æ”¹ lib/index.jsã€‚

22 è¡Œï¼š

```js
var _createHashHistory = _interopRequireDefault(
  require('history').createHashHistory
);
```

### ä¿®æ”¹å¯åŠ¨ç«¯å£

é¡¹ç›®è¿è¡Œç¼–è¯‘ä¸­ï¼Œç«¯å£è‹¥å‡ºç°å†²çªæç¤ºå¹¶åŒæ„ `æ–°ç«¯å£æ‰“å¼€`ï¼Œå¯èƒ½ä¼šæœ‰å¡æ­»æƒ…å†µå‘ç”Ÿï¼Œéœ€è¦ä¿®æ”¹å¯åŠ¨ç«¯å£ã€‚åœ¨ `package.json` ä¸­ä¿®æ”¹å‘½ä»¤å†…å®¹ï¼Œä¾‹å¦‚å°†ç«¯å£ä¿®æ”¹ä¸º9000ï¼š

```shell
 "start": "set PORT=9000 && roadhog server",
```

### ä½¿ç”¨ Hook

å¦‚æœéœ€è¦ä½¿ç”¨ `Hook` è€Œé Class ç¼–å†™ä»£ç ï¼Œè¯·åˆ é™¤ `node_modules` èµ„æºæ–‡ä»¶ï¼Œç„¶åä¿®æ”¹ `package.json` ä¸­çš„ React ç‰ˆæœ¬ï¼ˆ>=16.8ï¼‰ï¼Œå†é‡æ–°æ‹‰å–èµ„æºæ–‡ä»¶ã€‚

## å››ã€æ›´æ–°æƒ…å†µ

åé¢å¯èƒ½ä¼šè¯·æœ‹å‹å°†é¡¹ç›®ä¿®æ”¹ä¸º Hookç‰ˆæœ¬ï¼Œåˆ‡ä¸€ä¸ªåˆ†æ”¯å‡ºæ¥ï¼Œä¹Ÿè®¸ä¼šé¸½ğŸ•Šï¼ˆä¸è¦æ‰“æˆ‘ï¼‰ã€‚

## äº”ã€å…¶ä½™

è¿™ä¸ªé¡¹ç›®æ˜¯ä¸ªäººçš„ä½œå“ï¼Œéš¾å…ä¼šæœ‰é—®é¢˜å’Œ BUGï¼Œå¦‚æœæœ‰é—®é¢˜è¯·è¿›è¡Œè¯„è®ºï¼Œæˆ‘ä¹Ÿä¼šå°½åŠ›å»æ›´æ–°ï¼Œè‡ªå·±ä¹Ÿåœ¨å‰ç«¯å­¦ä¹ çš„è·¯ä¸Šï¼Œæ¬¢è¿äº¤æµï¼Œéå¸¸æ„Ÿè°¢ï¼
